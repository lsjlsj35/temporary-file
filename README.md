The theoretical derivation is  in the tmp_file.pdf
